---
layout:       post
title:        "记一次前端跨域的问题"
subtitle:     "自力更生, 丰衣足食"
date:         2019-05-13 12:00:00
author:       "Lorry"
header-mask:  0.3
header-img:   '/img/cors.png'
catalog:      true
multilingual: false
tags:
    - web
---
CORS(Cross Origin Resource Sharing), **一个为了前端的安全着想, chrome会拦截向不同源的网址请求资源,**.详见[维基百科](https://en.wikipedia.org/wiki/Same-origin_policy)这句话包含以下几个点:

1. 什么叫不同源(满足下列条件任意一个)

- 不同的域名(domain)
  - baidu.com 和google.com 这样名称不相同的就叫不同 domain
- 不同的端口
  - localhost:8000 和 localhost:3000
  - 如果不写端口号, 根据协议有默认值
    - http:  80
    - https: 443
    - ftp: 21
- 不同的协议
  - http://localhost:8000 和 https://localhost:8000

2. 什么叫拦截

- 这是 Chrome 的安全机制, 检测跨域之后就不让去发送请求, 都不会到达服务端.
- 可以在脚本中配置允许跨域, 比如 `fetch(url, {mode: 'no-cors'})`, 这样可以保证请求逃过 chrome, 成功发送到服务器
- 服务器在接受请求之后根据`Access-Control-Allow-origin`配置字段进行检测, 符合要求的才会返回数据, 否则会 deny 掉.
  - 最粗暴的方式就是在服务端设置`Access-Control-Allow-Origin`为`'*'`, 允许所有域的请求. 如果有特定要求也可指定特定域

